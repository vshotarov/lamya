{% macro nested_navigation(navigation_dict, indent_level=0, name="") -%}
{% filter indent(indent_level*4) %}
{% if name %}
<ul aria-hidden="true" aria-expanded="false" aria-label="{{ name }} submenu">
{% else %}
<ul id="menu" aria-expanded="true" aria-label="menu">
{% endif %}
	{% for name,href_or_submenu in navigation_dict.items() %}
	{% if href_or_submenu is mapping %}
	<li class="has-submenu">
		{% if href_or_submenu['self'] %}
		<a href="{{ href_or_submenu['self'] | urlencode }}" aria-haspopup="true">{{ name }}</a>
		{% else %}
		<span>{{ name }}</span>
		{% endif %}
		<img alt="" aria-hidden="true" src="/img/caret-down.svg">
		<button class="visually-hidden">Toggle submenu for "{{name}}"</button>
		{{ nested_navigation(href_or_submenu["children"], indent_level=2, name=name) }}
	{% else %}
	<li>
		<a href="{{ href_or_submenu | urlencode }}">{{ name }}</a>
	{% endif %}
	</li>
	{% endfor %}
</ul>
{%- endfilter %}
{%- endmacro -%}

{% block header %}
<header>
	<section aria-label="site name, description and mobile menu toggle button">
		<a href="/" aria-label="go to homepage">{{ site_info.name }}</a>
		{% if site_info.subtitle %}
			<p>{{ site_info.subtitle }}</p>
		{% endif %}
		<button id="menu-toggle" aria-label="mobile menu toggle"><img alt="" src="/img/menu-2.svg"></button>
	</section>
	<nav aria-label="main">
		{{ nested_navigation(site_info.navigation, 2) }}
	</nav>
</header>
{%- endblock %}
